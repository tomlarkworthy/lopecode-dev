{"id":"lopecode-dev-05b","title":"Expose __ojs_runtime on window in lopecode notebooks","status":"closed","priority":1,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T08:52:59.413736+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T12:23:09.941346+01:00","closed_at":"2026-01-20T12:23:09.941346+01:00","close_reason":"User pushed change exposing __ojs_runtime on window in reactive-reflective-testing notebook"}
{"id":"lopecode-dev-0oq","title":"Port opencode agentic loop to lopecode","description":"Epic: Port opencode's agentic loop into lopecode for browser-based AI-assisted notebook development. See OPENCODE_PORT_PLAN.md for detailed plan.\n\nSubtasks:\n- lopecode-dev-d1l: Message types\n- lopecode-dev-edx: Tool interface\n- lopecode-dev-fqh: Streaming LLM\n- lopecode-dev-c1f: Agentic loop (core)\n- lopecode-dev-6oy: Cell tools\n- lopecode-dev-sfm: Module/runtime tools\n- lopecode-dev-j8p: Conversation UI","status":"open","priority":1,"issue_type":"feature","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:25.113392+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:28:25.113392+01:00"}
{"id":"lopecode-dev-2cj","title":"Add persistent Playwright session with REPL interface","description":"Starting Playwright from scratch for each test run is expensive (~5-10s overhead). Implement a persistent browser session approach:\n\n1. **Server mode**: lope-runner.js --server starts a long-running process with browser open\n2. **REPL interface**: Accept commands via stdin/socket to:\n   - Load/reload notebooks\n   - Run tests\n   - Execute arbitrary JS in page context\n   - Query cell values\n3. **Benefits**:\n   - Fast iteration (\u003c1s for test runs after initial load)\n   - Interactive debugging\n   - Could integrate with editor/IDE\n\nPossible approaches:\n- Simple stdin/stdout JSON-RPC\n- Unix socket for programmatic access\n- WebSocket for remote/IDE integration\n\nRelated: This would enable watch mode for TDD workflows.","status":"closed","priority":2,"issue_type":"feature","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T13:58:24.184673+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T14:02:01.557642+01:00","closed_at":"2026-01-20T14:02:01.557642+01:00","close_reason":"Implemented lope-repl.js with persistent Playwright session. Commands: load, run-tests, eval, get-cell, list-cells, status, quit. ~10x faster than lope-runner.js for iterative development."}
{"id":"lopecode-dev-2fr","title":"Improve lope-utils.py HTML parsing robustness","description":"The HTML parser in lope-utils.py using Python's HTMLParser misses some modules in notebooks (showing empty modules dict). This may be due to HTML entities, script escaping, or large content handling. Investigate why some notebooks like @tomlarkworthy_lopecode-tour show 0 modules while they clearly contain lope-module scripts.","status":"closed","priority":3,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T08:17:42.806055+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T20:37:34.357252+01:00","closed_at":"2026-01-20T20:37:34.357252+01:00","close_reason":"lope-utils.py was removed during tooling consolidation - replaced by lope-reader.js which uses cheerio for robust HTML parsing"}
{"id":"lopecode-dev-6oy","title":"Implement notebook cell tools for opencode port","description":"Create notebook-specific tools: read_cell, write_cell, edit_cell, delete_cell, list_cells. Adapt from file-based tools to cell-based operations using defineVariable/deleteVariable patterns.","status":"open","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:16.580158+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:28:16.580158+01:00","dependencies":[{"issue_id":"lopecode-dev-6oy","depends_on_id":"lopecode-dev-edx","type":"blocks","created_at":"2026-01-20T21:28:43.192499+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-c1f","title":"Port opencode agentic loop to lopecode","description":"Port SessionPrompt.loop() core logic from opencode. Implement step limits, finish detection, and tool execution cycle. This is the central component. Reference: opencode/packages/opencode/src/session/prompt.ts","status":"in_progress","priority":1,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:15.898111+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:58:25.647599+01:00","dependencies":[{"issue_id":"lopecode-dev-c1f","depends_on_id":"lopecode-dev-d1l","type":"blocks","created_at":"2026-01-20T21:28:42.427295+01:00","created_by":"Tom Larkworthy"},{"issue_id":"lopecode-dev-c1f","depends_on_id":"lopecode-dev-edx","type":"blocks","created_at":"2026-01-20T21:28:42.670549+01:00","created_by":"Tom Larkworthy"},{"issue_id":"lopecode-dev-c1f","depends_on_id":"lopecode-dev-fqh","type":"blocks","created_at":"2026-01-20T21:28:42.922113+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-ced","title":"Test lope-runner.js --run-tests after runtime is exposed","status":"closed","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T08:52:59.889308+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T12:49:31.286519+01:00","closed_at":"2026-01-20T12:49:31.286519+01:00","close_reason":"Tested: Runtime IS exposed and accessible in reactive-reflective-testing notebook. --list-cells works correctly. --run-tests finds no suites because: (1) Observable runtime is lazy - suite cells aren't computed in headless mode without observers, (2) Detection logic only looks for suite pattern, not test_* pattern. These limitations are addressed by blocked issue lopecode-dev-uze which updates lope-runner.js to support the reactive testing pattern.","dependencies":[{"issue_id":"lopecode-dev-ced","depends_on_id":"lopecode-dev-05b","type":"blocks","created_at":"2026-01-20T08:53:12.24108+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-d1l","title":"Port opencode message types to lopecode","description":"Port MessageV2 types (User, Assistant) and message parts (Text, Tool, Reasoning) from opencode to lopecode. Adapt for Observable cell format and browser environment.","status":"closed","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:13.745568+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:51:40.703191+01:00","closed_at":"2026-01-20T21:51:40.703191+01:00","close_reason":"Closed"}
{"id":"lopecode-dev-edx","title":"Port opencode tool interface to lopecode","description":"Port Tool.Info interface and Tool.Context from opencode. Create tool registry for notebook tools. Reference: opencode/packages/opencode/src/tool/","status":"closed","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:14.471148+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:55:48.230695+01:00","closed_at":"2026-01-20T21:55:48.230695+01:00","close_reason":"Closed"}
{"id":"lopecode-dev-fqh","title":"Implement streaming LLM fetch for lopecode","description":"Adapt opencode LLM integration for browser using direct fetch with SSE parsing. Reuse modelConfig() pattern from robocoop-2. Support OpenAI and Anthropic streaming APIs.","status":"closed","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:15.182341+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:58:18.365573+01:00","closed_at":"2026-01-20T21:58:18.365573+01:00","close_reason":"Closed"}
{"id":"lopecode-dev-j8p","title":"Create conversation UI for lopecode agent","description":"Build chat interface cell for agent interactions. Include message history display, streaming response rendering, tool execution status, and error handling UI.","status":"open","priority":3,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:17.964687+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:28:17.964687+01:00","dependencies":[{"issue_id":"lopecode-dev-j8p","depends_on_id":"lopecode-dev-c1f","type":"blocks","created_at":"2026-01-20T21:28:43.684436+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-sfm","title":"Implement module and runtime tools for opencode port","description":"Create tools for module operations (list_modules, read_module, search_cells) and runtime operations (eval, get_value, run_tests). Leverage existing lope-repl.js patterns.","status":"open","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T21:28:17.286017+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:28:17.286017+01:00","dependencies":[{"issue_id":"lopecode-dev-sfm","depends_on_id":"lopecode-dev-edx","type":"blocks","created_at":"2026-01-20T21:28:43.441196+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-syz","title":"Add cell patching workflow for agent-assisted edits","description":"Since re-exporting notebooks is a browser-driven process, agents need a workflow for preparing cell changes that humans can apply. Create: (1) a JSON patch format for cell modifications, (2) a tool to generate patches from cell content, (3) documentation on the patch-apply workflow. This would allow agents to write cell changes that are easy to copy-paste into the browser editor.","status":"closed","priority":2,"issue_type":"feature","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T08:17:46.19094+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T21:01:06.547095+01:00","closed_at":"2026-01-20T21:01:06.547095+01:00","close_reason":"Implemented define-variable command in lope-repl.js. Agents can now define/redefine runtime variables via JSON: {cmd: 'define-variable', name: 'foo', definition: '() =\u003e 42', inputs: []}. Also clarified cells vs variables terminology."}
{"id":"lopecode-dev-uze","title":"Update lope-runner.js to support @tomlarkworthy/tests reactive testing pattern","status":"closed","priority":2,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T12:31:58.462112+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T13:37:12.318814+01:00","closed_at":"2026-01-20T13:37:12.318814+01:00","close_reason":"Implemented observer-based test_* pattern support. Tests now run by installing observers, marking variables reachable, and calling _computeNow(). 84/94 tests passing on reactive-reflective-testing notebook.","dependencies":[{"issue_id":"lopecode-dev-uze","depends_on_id":"lopecode-dev-ced","type":"blocks","created_at":"2026-01-20T12:32:03.997885+01:00","created_by":"Tom Larkworthy"}]}
{"id":"lopecode-dev-wr6","title":"Remove runtime instrumentation hack from lope-runner.js","status":"closed","priority":3,"issue_type":"task","owner":"tom.larkworthy@gmail.com","created_at":"2026-01-20T08:53:00.285944+01:00","created_by":"Tom Larkworthy","updated_at":"2026-01-20T20:38:46.650809+01:00","closed_at":"2026-01-20T20:38:46.650809+01:00","close_reason":"Keeping the instrumentation hack - forcing cell reachability is useful for running tests in notebooks that don't have the tests module rendered. Both approaches now available: force (run-tests) and natural observation (read-tests with hash URL)","dependencies":[{"issue_id":"lopecode-dev-wr6","depends_on_id":"lopecode-dev-ced","type":"blocks","created_at":"2026-01-20T08:53:12.490664+01:00","created_by":"Tom Larkworthy"}]}
